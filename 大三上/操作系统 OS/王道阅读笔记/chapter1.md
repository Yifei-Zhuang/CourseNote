据说这门书作为入门书籍读起来还挺好的，于是找了一个pdf看看。

# 第一章 计算机系统概述

## 1.1 基本概念

都是一些计原的东西

- 计算机系统：硬件、操作系统、应用程序和硬件
- OS就是管理各种计算机资源，为用户程序提供服务的程序集合。（但是在nju JYY老师看来，OS就是一个中断服务管理器，更深刻地说，是一个状态机状态转移的控制器）
- 最基本的特征
  - 并发：宏观上，一系列程序在一定的时间段内同时执行，实际上一个时刻只有一个程序在运行，微观上程序执行是串行的。这一点和并行不同，并行是在同一时刻执行多个计算任务。
  - 共享：系统中的资源可以供给多个进程共同使用
    - 互斥共享
      - 某些硬件资源，比如打印机等，以及计算机中的部分栈、变量和表格等临界资源都是互斥共享的，同一时刻只能服务一个进程，其他进程需要等待。
    - 同时访问
      - 部分资源可以同时向多个进程提供服务，比如硬盘。
    - 区别：互斥共享要求资源一段时间内只能服务一个进程，而同时访问可以让多个进程在不同的时间切片间隔完成，效果和串行等价（db串行化调度即视感）
  - 并发和共享两者是互相依存的
- 虚拟：操作系统可以虚拟出多个处理器，内存等，为进程提供五福。
- 异步：由于计算资源有限，进程的执行速度不可预知，不是一贯到底的。操作系统必须保证在初始条件相同时得到的结果完全一致。
- 操作系统接口：
  - 命令接口
    - 联机命令接口（交互式命令接口），顾名思义，就是类似shell的命令接口
    - 脱机命令接口，主要指批处理系统
  - 程序接口
    - 程序接口由一系列的系统调用（广义指令）组成，比较流行的是GUI。

### 1.2 发展和分类

- 感觉发展过程不是很重要，就不写了。
- 分时操作系统：将处理器的运行时间分成很短的时间片，按时间片轮流吧处理器分配给各个进程服务。
  - 同时性：多个用户可以操作一个计算机
  - 交互性：通过终端控制计算机行为
  - 独立性：类似数据库事务的隔离性，各个用户的进程之间互不干扰。
  - 及时性：由于时间分片，用户请求响应时间更短。
- 实时操作系统：每隔一定的时间短一定要发生一定的事件，比如飞控系统。
- 网络操作系统和分布式计算机系统
- 个人操作系统
- 。。。

## 1.3 操作系统运行环境

- s特权态（核心态）和用户态
  - 处在用户态的进程只能够执行非特权指令
  - 处在核心态的进程不仅可以执行非特权指令，还可以执行特权指令。
- 内核
  - 时钟管理
    - 计时
    - 进程切换（分时系统）
    - 批处理系统中衡量工作状态
  - 中断机制
    - 提高cpu利用率
    - 只有一部分属于内核，负责存储和恢复中断信息，减少中断的处理时间，提高系统的并行计算能力。
  - 原语
    - 处在系统最底层的一些公用、调用频繁的小程序。
    - 运行具有原子性（一种实现方法是在调用钱关闭中断检查，结束后重启中断机制）。
  - 系统控制
    - 进程管理
    - 存储器管理
    - 设备管理
- 中断和异常的定义介绍。异常指的主要是非法指令，非法操作内存，缺页等。
- 中断流程
  1. 关闭中断许可。
  2. 保存PC
  3. 将中断向量表中的中断服务地址存入PC
  4. 进入PC对应地址之后，保存部分信息，比如PWSR和部分通用寄存器
  5. 开启中断许可
  6. 执行中断服务
  7. 关闭中断许可
  8. 恢复现场（PWSR的值等等）
  9. 开启中断
  10. 回到原来的PC地址
- 系统调用（类似LC3中的trap）
  - 用户程序调用trap将cpu移交给内核程序，内核处理完毕之后将cpu交还给用户程序。
- 用户态和核心态之间转换的方式：
  - 系统调用
  - 中断
  - 产生错误
  - 越权执行指令
  - 核心态回到用户态



## 5. I/O

- 按信息交换单元分类：
  - 块设备，典型为硬盘，内存
  - 字符设备，比如终端，打印机
-  驱动方式
  - 直接驱动：CPU直接向IO设备发出指令，之后不断检查IO设备的状态，一旦准备好，就直接从钟读取数据。特点是CPU在这个过程中不能够执行其他进程（当然，这个和调度有关系）
  - 中断驱动：CPU直接给IO设备发出指令，之后保存当前上下文，去执行其他挂起的进程，一旦IO设备执行完毕，就会设置一个中断位，CPU会在每一个指令周期的末尾检查该标志，此时CPU就会切换到内核态继续IO过程（字符IO都要经过CPU）
  - DMA驱动：和中断驱动类似，但是数据传输不需要经过CPU
- IO子系统
  - IO调度
    - 为每一个设备建立一个等待队列，尽量让每一个进程都能够公平地进行社别访问，减少IO平均等待时间
  - 高速缓存和缓冲区
  - 设备分配和回收
  - 假脱机
  - 设备保护
  - 差错处理





























































